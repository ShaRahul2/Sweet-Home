# Sweet-Home
We are breaking the Hotel room booking application into three different microservices, which are as follows:  Booking service - This service is exposed to the outer world and is responsible for collecting all information related to user booking. Payment service - This is a dummy payment service; this service is called by the booking service for initiating payment after confirming rooms. Notification service - When payment is done and all data is saved properly, the booking service puts a message object on the Kafka topic, and then, the notification service reads that message from the Kafka topic and prints the message to the console.

<div class="component-list fixed-main-container"><h1 class="segment-heading-text bold-font">Tasks</h1><div class="component-list-items"><div class="text-component-item" id="component-c1709"><div class="text-container"><p>In this segment, the complete description of the project is specified. Before you proceed with</p><p>the tasks, please take a look at the schema of the database for each service.</p></div></div><div class="text-component-item" id="component-c1715"><div class="text-container"><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>1. Create a folder “Sweet-Home”.</strong></p><p style="margin-bottom: 0px;"><strong>NOTE: </strong>Please use the same naming convention as specified in the problem statement and schema.</p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>2.</strong> Create <strong>project structure</strong> using Spring Initializer for the microservices- 'Booking'&nbsp; and 'Payment'&nbsp;- and 'Eureka' server inside “Sweet-Home”.</p><div id="code-snippet-cke_2880" data-lang="text" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>Spring Initializer URL: https://start.spring.io/
</pre></div></div><p style="margin-bottom: 0px;">Note that&nbsp;'Notification' service will not be a Spring project, rather it will be a&nbsp; Maven based Java<strong>&nbsp;</strong>project which will simply subscribe to Kafka topic.</p><p>&nbsp;</p><p>Following are the dependecies for each services:</p><p>&nbsp;</p><p style="margin-bottom: 0px;">&nbsp;<strong> a. Booking Service:</strong></p><ul><li>Eureka Discovery Client</li><li>Spring Data JPA</li><li>MySQL Driver</li><li>Spring Web</li><li>Add the following dependency in pom.xml.&nbsp; &nbsp;</li></ul><div id="code-snippet-cke_2900" data-lang="xml" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #007700">&lt;dependency&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<span style="color: #007700">&lt;groupId&gt;</span>org.apache.kafka<span style="color: #007700">&lt;/groupId&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;             &nbsp; <span style="color: #007700">&lt;artifactId&gt;</span>kafka-clients<span style="color: #007700">&lt;/artifactId&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<span style="color: #007700">&lt;version&gt;</span>2.7.0<span style="color: #007700">&lt;/version&gt;</span>
&nbsp; <span style="color: #007700">&lt;/dependency&gt;</span>
</pre></div></div><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>b. Payment Service:</strong></p><ul><li>Eureka Discovery Client</li><li>Spring Data JPA</li><li>MySQL Driver</li><li>Spring Web</li></ul><p style="margin-bottom: 0px;"><strong>c. Notification Service:</strong></p><p>&nbsp;</p><p style="margin-bottom: 0px;">&nbsp;It is a simple <strong>Java-Maven&nbsp;project </strong>that subscribes to a particular Kafka topic. You can download the 'pom.xml' file for this service from the bottom of this page. Please note that the&nbsp; pom.xml is configured for java version 11 and if you are&nbsp;working on a different version, please modify&nbsp;the file accordingly.</p><p>&nbsp;</p><ul></ul><p style="margin-bottom: 0px;"><strong>d. Eureka Server:</strong></p><ul><li>Dependencies: Eureka Server</li><li>Open the Eureka server and annotate the main class with proper annotation so that the Eureka server gets enabled.</li><li>Set properties for running standalone Eureka servers.</li><li>Set port for Eureka server as 8761.</li></ul><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>3.&nbsp;Creation of RDS instance:</strong></p><p style="text-align: justify; margin-bottom: 0px;">Create a single RDS instance and create separate databases to host the booking and transaction table as per the <strong>Sweet-Home</strong> schema. Please make sure that the MySQL database</p><p style="text-align: justify;">on AWS RDS is set up before starting. You can refer to the documents given below for the set-up.</p></div></div><div class="text-component-item" id="component-c1721"><div class="text-container"><p style="margin-bottom: 0px;"><strong>Important Note:</strong><br>Amazon RDS is a costly service of AWS. Hence to avoid burning up your monthly AWS budget, Please make sure to delete your RDS DB Instance once done. If you are not planning to use your RDS DB instance (After the project or you have 2-3 days break) for a while we highly recommend you delete the database in that case. Please follow the below steps to delete the RDS DB instance. This must be done to avoid burning your AWS budgets.</p></div></div><div class="text-component-item" id="component-c1727"><div class="text-container"><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>4. Booking Service:</strong><br>This service is responsible for taking input from users like- toDate, fromDate, aadharNumber and the number of rooms required (numOfRooms) and save it in its RDS database. This service&nbsp;also generates a random list of room numbers depending on 'numOfRooms'&nbsp;requested by the user and returns the room number list (roomNumbers) and total roomPrice to the user. The formulae to calculate room price is as follows:&nbsp;</p><div id="code-snippet-cke_30" data-lang="java" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>roomPrice <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1000</span><span style="color: #333333">*</span> numOfRooms<span style="color: #333333">*(</span>number of days<span style="color: #333333">)</span>
Here<span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">1000</span> INR is the base price<span style="color: #333333">/</span>day<span style="color: #333333">/</span>room<span style="color: #333333">.</span>
</pre></div></div><p>&nbsp;</p><p>&nbsp;If the user wishes to go ahead with the booking, they can provide the payment related details like bookingMode, upiId / cardNumber, which will be further sent to the payment service to retrieve the transactionId. This transactionId&nbsp;then gets updated in the Booking table created in the RDS database of the Booking service and a notification is sent to the user about their booking confirmation.</p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>A sample code that you could refer to create random room numbers is as follows:&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</strong><br>/* The following code snippet returns a random number list with upperbound of 100 and 'count' number of entries in the number list*/&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</p><p>&nbsp;</p><div id="code-snippet-cke_2910" data-lang="java" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> ArrayList<span style="color: #333333">&lt;</span>String<span style="color: #333333">&gt;</span> <span style="color: #0066BB; font-weight: bold">getRandomNumbers</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> count<span style="color: #333333">){</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;
         Random rand <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Random<span style="color: #333333">();</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;
         <span style="color: #333399; font-weight: bold">int</span> upperBound <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">100</span><span style="color: #333333">;</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;
         ArrayList<span style="color: #333333">&lt;</span>String<span style="color: #333333">&gt;</span>numberList <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> ArrayList<span style="color: #333333">&lt;</span>String<span style="color: #333333">&gt;();</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;

        <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i<span style="color: #333333">&lt;</span>count<span style="color: #333333">;</span> i<span style="color: #333333">++){</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;
                    numberList<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>String<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>rand<span style="color: #333333">.</span><span style="color: #0000CC">nextInt</span><span style="color: #333333">(</span>upperBound<span style="color: #333333">)));</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;
         <span style="color: #333333">}</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;

          <span style="color: #008800; font-weight: bold">return</span> numberList<span style="color: #333333">;</span>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;
<span style="color: #333333">}</span>
</pre></div></div><p>&nbsp;</p><p style="margin-bottom: 0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br><strong>Output:&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</strong> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</p><div id="code-snippet-cke_2911" data-lang="text" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>for count=5, numberList contains any 5 numbers between 0 and 100&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
</pre></div></div><p>&nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp;</p><p style="margin-bottom: 0px;"><strong>4.1&nbsp;&nbsp; &nbsp;Model Classes:</strong><br>Refer to the “booking” table in the schema to create the entity class named “<strong>BookingInfoEntity</strong>”.&nbsp;</p><p style="margin-bottom: 0px;"><br>&nbsp;4<strong>.2 &nbsp;&nbsp;Controller Layer:</strong><br>&nbsp;</p><p style="margin-bottom: 0px;"><strong>Endpoint 1: </strong>This endpoint is responsible for collecting information like fromDate, toDate,aadharNumber,numOfRooms from the user and save it in its database.</p><ul><li style="margin-bottom: 0px;">&nbsp;<strong>URI</strong>: /booking</li><li style="margin-bottom: 0px;">&nbsp;<strong>HTTP METHOD</strong>: POST</li><li style="margin-bottom: 0px;"><strong>&nbsp;RequestBody</strong>: fromDate, toDate,aadharNumber,numOfRooms</li></ul><p>&nbsp;</p></div></div><div class="image-component component-item" id="component-c1730"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/a4d0f8a2-36f3-4aee-aa56-d29b8b35a527-Capture5.1.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Request Body</div></div></div></div><div class="text-component-item" id="component-c1733"><div class="text-container"><ul><li style="margin-bottom: 0px;"><strong>Response Status:</strong> Created</li><li style="margin-bottom: 0px;"><strong>Response</strong>: ResponseEntity&lt;BookingInfoEntity&gt;</li></ul></div></div><div class="image-component component-item" id="component-c1736"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/e134f424-23f3-48cd-adc3-d05448c2b727-Capture5.1 response.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Response</div></div></div></div><div class="text-component-item" id="component-c1739"><div class="text-container"><p style="margin-bottom: 0px;"><strong>Note 1: </strong>The value of the transactionId returned is 0. It means that no transaction is made for this booking. Once the transaction is done, the transactionId field in the booking table will get replaced with the transactionId received from the Payment service.</p><p style="margin-bottom: 0px;"><br><strong>Note 2: </strong>The room numbers displayed are not based on the availability of vacant rooms. They are rather randomly generated integers between 1 and 100. This is done to trim down the complexity of the problem statement. &nbsp;</p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>Note 3</strong>: The field 'id' in the response body represents the 'BookingId'.<br>&nbsp;</p><p style="margin-bottom: 0px;"><strong>Endpoint 2: </strong>This endpoint is responsible for taking the payment related details from the user and sending it to the payment service. It gets&nbsp;the transactionId from the Payment service in respose&nbsp;and saves it in the booking table. Please note that for the field 'paymentMode', if the user provides any&nbsp;input other than 'UPI'&nbsp;or 'CARD', then it means that the user is not interested in the booking and wants to opt-out.</p><ul><li style="margin-bottom: 0px;"><strong>URL</strong>: booking/{bookingId}/payment</li><li style="margin-bottom: 0px;"><strong>HTTP METHOD</strong>: POST</li><li style="margin-bottom: 0px;"><strong>PathVaraiable</strong>: int</li><li style="margin-bottom: 0px;"><strong>RequestBody</strong>: paymentMode, bookingDate,amount,upiId,cardNumber</li></ul></div></div><div class="image-component component-item" id="component-c1742"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/21dbf6ad-ce5b-46de-a715-124d58ed2ffa-Capture5.2 .PNG"><div class="bold-font image-title component-heading-name text-center large-font">Request Body</div></div></div></div><div class="text-component-item" id="component-c1745"><div class="text-container"><ul><li style="margin-bottom: 0px;"><strong>Response Status:</strong> Created</li><li style="margin-bottom: 0px;"><strong>Response</strong>: ResponseEntity&lt;BookingInfoEntity&gt;</li></ul></div></div><div class="image-component component-item" id="component-c1748"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/d8b0ec61-aef0-4aa7-bd6d-272a60c2b868-Capture5.2 response.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Response</div></div></div></div><div class="text-component-item" id="component-c1751"><div class="text-container"><p style="margin-bottom: 0px;"><strong>Note that the transaction Id this time stores the actual transactionId associated with the transaction.&nbsp;</strong></p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>Exception 1: </strong>If the user gives any other input apart from “UPI” or “CARD”, the response message should look like the following:</p><div id="code-snippet-cke_2950" data-lang="json" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>{
&nbsp; &nbsp;<span style="color: #007700">"message"</span>: <span style="background-color: #fff0f0">"Invalid mode of payment"</span>,
&nbsp; <span style="color: #007700">"statusCode"</span>: <span style="color: #0000DD; font-weight: bold">400</span>
}
</pre></div></div><p>&nbsp;</p></div></div><div class="image-component component-item" id="component-c1754"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/4a5faf72-e9dd-41a5-bd5a-0b7bbebb81f4-Exception1.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Exception 1</div></div></div></div><div class="text-component-item" id="component-c1757"><div class="text-container"><p style="margin-bottom: 0px;"><strong>Exception 2:</strong> If no transactions exist for the Booking Id passed to this endpoint then the response message should look like the following:&nbsp;</p><div id="code-snippet-cke_2960" data-lang="json" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>{
&nbsp; &nbsp;<span style="color: #007700">"message"</span>: <span style="background-color: #fff0f0">" Invalid Booking Id "</span>,
&nbsp; <span style="color: #007700">"statusCode"</span>: <span style="color: #0000DD; font-weight: bold">400</span>
}
</pre></div></div><p>&nbsp;</p></div></div><div class="image-component component-item" id="component-c1760"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/f9d79077-8d21-4db7-b238-3a703fbe8500-Exception2.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Exception2</div></div></div></div><div class="text-component-item" id="component-c1763"><div class="text-container"><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>4.3</strong>&nbsp;&nbsp;&nbsp;Configure this service to run on port number 8080.<br><strong>4.4 </strong>&nbsp;&nbsp; Configure the hotel booking service as Eureka &nbsp;Client<br>&nbsp;<br>Once the configuration is done properly for this service, run the Eureka server and Booking service on your localhost. Post this when you hit the Eureka server IP from your Internet Explorer, you will see something similar.&nbsp;<br><strong>Address</strong>:</p><div id="code-snippet-cke_2970" data-lang="tex" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>http://localhost:8761/
</pre></div></div><p>&nbsp;</p></div></div><div class="image-component component-item" id="component-c1766"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/e0f24e07-292e-4871-acb9-0c92398abe82-eureka.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Eureka UI</div></div></div></div><div class="text-component-item" id="component-c1769"><div class="text-container"><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>5. Payment Service:</strong><br><br>This service is responsible for taking payment-related information- paymentMode, upiId or cardNumber, bookingId and returns a unique transactionId to the booking service. It saves the data in its RDS database and returns the transactionId as a response.</p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>5.1 Model Classes:</strong><br>Refer to the “transaction” table in the schema to create the entity class named “TransactionDetailsEntity”.<br><br><strong>5.2 Controller Layer:</strong></p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>Endpoint 1: </strong>This endpoint is used to imitate performing a transaction for a particular booking. It takes details such as bookingId, paymentMode,upiId or cardNumber and returns the transactionId automatically generated while storing the details in the ‘transaction’ table. Note that this 'transactionId' is the primary key of the record that is being stored in the 'transaction' table.&nbsp;<br><br>After recieving the transactionId from 'Payment' service, all the booking details is then sent to the 'Payment' service via Kafka.&nbsp;&nbsp;<strong>Message String: </strong>&nbsp;</p><ul><li><div id="code-snippet-cke_3020" data-lang="java" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>String message <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"Booking confirmed for user&nbsp;with aadhaar number: "</span> <span style="color: #333333">+</span> bookingInfo<span style="color: #333333">.</span><span style="color: #0000CC">getAadharNumber</span><span style="color: #333333">()</span> <span style="color: #333333">+</span>&nbsp;&nbsp; &nbsp;<span style="background-color: #fff0f0">" &nbsp; &nbsp;| &nbsp; &nbsp;"</span>&nbsp; <span style="color: #333333">+</span>&nbsp;<span style="background-color: #fff0f0">"Here are the booking details: &nbsp; &nbsp;"</span> <span style="color: #333333">+</span> bookingInfo<span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">();</span>
</pre></div></div></li></ul><p style="margin-bottom: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><strong>Note: </strong>This endpoint will be called by the ‘endpoint 2’ of the Booking&nbsp;service.&nbsp;</p><ul><li style="margin-bottom: 0px;"><strong>URL</strong>: /transaction&nbsp;</li><li style="margin-bottom: 0px;"><strong>HTTP METHOD:</strong> POST</li><li style="margin-bottom: 0px;"><strong>RequestBody:</strong> bookingId, paymentMode, upiId, cardNumber</li></ul></div></div><div class="image-component component-item" id="component-c1772"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/c03bf819-d07a-45f6-a1e1-8b6a54bc0ba9-Requestbody6.1.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Request Body</div></div></div></div><div class="text-component-item" id="component-c1775"><div class="text-container"><p style="margin-bottom: 0px;"><strong>Response Status</strong>: Created</p><p style="margin-bottom: 0px;"><strong>Response</strong>: ResponseEntity&lt;transactionId&gt;</p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>EndPoint 2: </strong>This endpoint presents the transaction details to the user based on the transactionId provided by the user.</p><ul><li style="margin-bottom: 0px;">&nbsp;<strong>URL</strong>: /transaction/{transactionId}</li><li style="margin-bottom: 0px;"><strong>&nbsp;HTTP METHOD:</strong> GET</li><li style="margin-bottom: 0px;"><strong>&nbsp;RequestBody</strong>: (PathVaraiable) int</li><li style="margin-bottom: 0px;"><strong>&nbsp;Response Status</strong>: OK</li><li style="margin-bottom: 0px;"><strong>&nbsp;Response:</strong> ResponseEntity&lt;TransactionDetailsEntity&gt;</li></ul></div></div><div class="image-component component-item" id="component-c1778"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/313b1f9b-6848-4fb2-b369-3c46bf6a52a6-6.2.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Response</div></div></div></div><div class="text-component-item" id="component-c1781"><div class="text-container"><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>5.3 </strong>Configure the service to run on port 8083.</p><p style="margin-bottom: 0px;"><strong>&nbsp;5.4</strong> Configure the service as a Eureka client.&nbsp;</p><p>&nbsp;</p><p style="margin-bottom: 0px;">Once the Eureka client configuration is done properly for this service, and the Eureka server and Booking service is running on your localhost, you will see something similar when you hit the Eureka server IP from your Internet Explorer<br><strong>Address</strong>:</p><div id="code-snippet-cke_3000" data-lang="tea" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>http://localhost:8761/
</pre></div></div><p>&nbsp;</p></div></div><div class="image-component component-item" id="component-c1784"><div class="image-container placeholder-part"><div class="image-placeholder-thumbnail-container"><img class="image-thumbnail" src="https://images.upgrad.com/1f8e0fc7-1d0c-4240-915d-2f487a3c9e56-6.4.PNG"><div class="bold-font image-title component-heading-name text-center large-font">Eureka</div></div></div></div><div class="text-component-item" id="component-c1787"><div class="text-container"><p style="margin-bottom: 0px;"><strong>Hint: </strong>Synchronous communication between booking and payment service has to be set up using the REST template of Spring Boot. Please refer to the module of “ Discovery and communication between Microservices” for the same.</p><p>&nbsp;</p><p style="margin-bottom: 0px;"><strong>6. Notification Service:</strong></p><p>This service consumes the messages published by the Booking service on Kafka and prints the same on the console. This service will be created while establishing asynchronous communication using Kafka.</p><p style="margin-bottom: 0px;"><strong>6.1&nbsp; Kafka Pre-requirement:Run Kafka on an AWS EC2 &nbsp;instance.</strong></p><p style="text-align: justify; margin-bottom: 0px;">&nbsp; &nbsp; &nbsp; Please navigate to Segment 7 of Session 2 of module&nbsp;'<strong>Asynchronous communication using messaging models</strong>’ to get the detailed steps to run Kafka on EC2. Also, you can refer to the following documents to set up IP on EC2 and for starting the zookeeper and Kafka server.</p><p style="text-align: justify;">&nbsp;</p></div></div><div class="text-component-item" id="component-c1796"><div class="text-container"><p style="text-align: justify; margin-bottom: 0px;">Create a topic named <strong>‘message’</strong>.</p><p style="text-align: justify; margin-bottom: 0px;"><strong>Note</strong>: Please keep your EC2 instance in the stopped state once you are done for the day.</p><p style="text-align: justify;">&nbsp;</p><p style="text-align: justify; margin-bottom: 0px;"><strong>6.2&nbsp; &nbsp;Configure hotel booking service as a publisher</strong></p><ul><li style="text-align: justify;">In the Config package of hotel booking service, create a class name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;KafkaConfig.java&nbsp;</li><li style="text-align: justify;">Annotate it with proper annotation for making it a Configuration class</li><li style="text-align: justify;">Create a Bean that sets up all properties required by the Kafka Client</li><li style="text-align: justify;">Return a producer &lt;String, String&gt; instance from this bean</li><li style="text-align: justify;">Autowire Producer in BookingService class</li><li style="text-align: justify;">After saving the transactionId in the booking table,&nbsp;publish a message to&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Kafka on the message topic</li><li style="text-align: justify; margin-bottom: 0px;"><strong>Message String: </strong>&nbsp;</li></ul><div id="code-snippet-cke_3020" data-lang="java" class="code-snippet-container"><div contenteditable="false" class="code"><pre style="margin: 0; line-height: 125%"><span></span>String message <span style="color: #333333">=</span> <span style="background-color: #fff0f0">"Booking confirmed for user&nbsp;with aadhaar number: "</span> <span style="color: #333333">+</span> bookingInfo<span style="color: #333333">.</span><span style="color: #0000CC">getAadharNumber</span><span style="color: #333333">()</span> <span style="color: #333333">+</span>&nbsp;&nbsp; &nbsp;<span style="background-color: #fff0f0">" &nbsp; &nbsp;| &nbsp; &nbsp;"</span>&nbsp; <span style="color: #333333">+</span>&nbsp;<span style="background-color: #fff0f0">"Here are the booking details: &nbsp; &nbsp;"</span> <span style="color: #333333">+</span> bookingInfo<span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">();</span>
</pre></div></div><p>&nbsp;</p><p style="text-align: justify; margin-bottom: 0px;"><strong>6.3&nbsp; Configure Notification service as a subscriber:</strong></p><ul><li style="text-align: justify;">In the Notification Service project, create Consumer Class and the main method.</li><li style="text-align: justify;">Set all properties required by the Kafka consumer.</li><li style="text-align: justify;">Subscribe to the “message” topic.</li><li style="text-align: justify;">Start consuming messages in a forever loop for notification service using Kafka.</li><li style="text-align: justify;">Start printing record values on the console.</li></ul><p style="margin-bottom: 0px;"><strong>Note: Always use Constructor Autowiring only for Autowiring. The reason for this is that it does not let objects be created unless the dependency exists. This enhances security.</strong></p></div></div></div></div>
